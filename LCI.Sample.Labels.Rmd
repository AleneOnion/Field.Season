---
output: 
  word_document:
    reference_docx: word_styles-reference-labels.docx
---

```{r setup, include=FALSE}

#Instructions on how to use:
#print the output to 255 but change the source to bypass and the paper to thick2
#place the label paper upside down and with the top towards the outside

knitr::opts_chunk$set(echo = FALSE)
```

```{r, echo=FALSE, results='asis', message=FALSE, warning=FALSE}
library(openxlsx)
#read in table types
bottles<-read.xlsx("data/New York State Office of Information Technology Services/Sampling Season - Documents/LCI.Field.Season.xlsx", 6)
intensive<-read.xlsx("data/New York State Office of Information Technology Services/Sampling Season - Documents/LCI.Field.Season.xlsx", 5)

#realine the table
library(tidyr)
intensive <- intensive %>% 
  gather(type, sample, Sample1:Sample4)

#merge to create a list of labels
labels<-merge(bottles,intensive,by=c('class','layer'),all=TRUE)
labels<-labels[!is.na(labels$sample),]
labels<-labels[!is.na(labels$Parameter),]
labels<-labels[order(labels$type,labels$sample,labels$Parameter),]

#####################################################################################################################
#####################################################################################################################
#####################################################################################################################
#####################################################################################################################
#####################################################################################################################
#####################################################################################################################
#specifying which to print
labels<-labels[labels$type=="Sample4",]
labels<-labels[labels$basingrouping=="Delaware",]
#labels<-labels[labels$Parameter=="TOC (in H2SO4)",]
#labels<-labels[labels$Lake=="none",]
#labels<-labels[labels$sample=="19SUS096",]
#labels<-labels[labels$Lake=="Duplicate epi"|labels$Lake=="Duplicate hypo",]
#####################################################################################################################
#####################################################################################################################
#####################################################################################################################
#####################################################################################################################
#####################################################################################################################
#####################################################################################################################
labels<-labels[order(labels$type,labels$sample,labels$Parameter),]
```


```{r echo = FALSE, results = "asis"}
#try this: https://stackoverflow.com/questions/36674824/use-loop-to-generate-section-of-text-in-rmarkdown

template1 <- "SampleID: %s\n
Name: %s\n
##     mm/dd/yyyy  hh:mm\n" # dont't forget the newline

template2 <- "%s\n"
template3 <- "###%s\n"

template4 <- "........................................\n
\n"
template5 <- "\n"


for (i in seq(nrow(labels))) {
  current <- labels[i, ]
  cat(sprintf(template1, current$sample, current$Lake))
  if(current$Parameter!="Diss TPO4 (in H2SO4)FILTRD"&&current$Parameter!="Chl A, Vol Filtered:____________"&&current$Parameter!="DOC (in H2SO4)FILTERED"){
    cat(sprintf(template2,current$Parameter))
    }
  if(current$Parameter=="Diss TPO4 (in H2SO4)FILTRD"|current$Parameter=="Chl A, Vol Filtered:____________"|current$Parameter=="DOC (in H2SO4)FILTERED"){
    cat(sprintf(template3,current$Parameter))
    }
  cat(sprintf(template4))
}

rm(list=ls())
```
